@* @model TicketPortal09.Models.Ticket

@{
    ViewData["Title"] = "Create";
}

<h1>Create Ticket</h1>

<form asp-action="Create">
    <div class="form-group">
        <label asp-for="Title">Title</label>
        <input asp-for="Title" class="form-control" />
        <span asp-validation-for="Title" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="Description">Description</label>
        <textarea asp-for="Description" class="form-control" rows="4"></textarea>
        <span asp-validation-for="Description" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="CategoryId">Category</label>
        <select asp-for="CategoryId" class="form-control" asp-items="@(new SelectList(ViewBag.Category, "CategoryId", "Name"))">
            <option value="">Select Category</option>
        </select>
        <span asp-validation-for="CategoryId" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="SubcategoryId">Subcategory</label>
        <select asp-for="SubcategoryId" class="form-control" asp-items="@(new SelectList(ViewBag.Subcategory, "SubcategoryId", "Name"))">
            <option value="">Select Subcategory</option>
        </select>
        <span asp-validation-for="SubcategoryId" class="text-danger"></span>
    </div>
    <button type="submit" class="btn btn-primary">Create</button>
</form> *@






@if (User.IsInRole("Admin"))
{
    
    <h1>Admin Dashboard</h1>
    <p>Welcome, Admin!</p>
    <h2>Previous Created Tickets</h2>
    <ul>
        @foreach (var ticket in Model.AdminTickets)
        {
            <li>
                Ticket ID: @ticket.TicketId<br />
                Title: @ticket.Title<br />
                Description: @ticket.Description<br />
                Status: @ticket.Status<br />
                
                <a href="@Url.Action("Edit", "Tickets", new { id = ticket.TicketId })">Edit</a>
            </li>
        }
    </ul>
}

@if (User.IsInRole("Manager"))
{
   
    <h1>Manager Dashboard</h1>
    <p>Welcome, Manager!</p>
    <h2>All Tickets</h2>
    <ul>
        @foreach (var ticket in Model.AllTickets)
        {
            <li>
                Ticket ID: @ticket.TicketId<br />
                Title: @ticket.Title<br />
                Description: @ticket.Description<br />
                Status: @ticket.Status<br />
                
                <a href="@Url.Action("Reassign", "Tickets", new { id = ticket.TicketId })">Reassign</a>
            </li>
        }
    </ul>
}

@if (User.IsInRole("Agent"))
{
   
    <h1>Agent Dashboard</h1>
    <p>Welcome, Agent!</p>
    <h2>Your Assigned Tickets</h2>
    <ul>
        @foreach (var ticket in Model.AgentTickets)
        {
            <li>
                Ticket ID: @ticket.TicketId<br />
                Title: @ticket.Title<br />
                Description: @ticket.Description<br />
                Status: @ticket.Status<br />
                
                <form asp-action="UpdateTicketStatus" asp-route-id="@ticket.TicketId">
                    <select name="status">
                        <option value="Open">Open</option>
                        <option value="Assigned">Assigned</option>
                        <option value="Closed">Closed</option>
                    </select>
                    <button type="submit">Update Status</button>
                </form>
             
                <form asp-action="AddRemarks" asp-route-id="@ticket.TicketId">
                    <textarea name="remarks"></textarea>
                    <button type="submit">Add Remarks</button>
                </form>
            </li>
        }
    </ul>
}
